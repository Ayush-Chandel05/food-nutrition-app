[... full app.py code from earlier canvas update ...]